{"version":3,"file":"index.js","sources":["src/api/index.ts"],"sourcesContent":["/**\n * 云函数调用封装\n * 统一处理云函数调用、错误处理、loading状态\n */\n\ntype CloudFunctionResult<T = any> = {\n  success: boolean\n  data?: T\n  errMsg?: string\n}\n\ntype CallFunctionOptions = {\n  showLoading?: boolean\n  loadingText?: string\n  showError?: boolean\n}\n\n/**\n * 调用云函数基础方法\n */\nasync function callFunction<T = any>(\n  name: string,\n  data: Record<string, any> = {},\n  options: CallFunctionOptions = {}\n): Promise<CloudFunctionResult<T>> {\n  const { showLoading = false, loadingText = '加载中...', showError = true } = options\n\n  if (showLoading) {\n    uni.showLoading({ title: loadingText, mask: true })\n  }\n\n  try {\n    const result = await uni.cloud.callFunction({\n      name,\n      data\n    })\n\n    if (showLoading) {\n      uni.hideLoading()\n    }\n\n    const res = result.result as CloudFunctionResult<T>\n\n    if (!res.success && showError) {\n      uni.showToast({\n        title: res.errMsg || '请求失败',\n        icon: 'none'\n      })\n    }\n\n    return res\n  } catch (err: any) {\n    if (showLoading) {\n      uni.hideLoading()\n    }\n\n    console.error(`云函数 ${name} 调用失败:`, err)\n\n    if (showError) {\n      uni.showToast({\n        title: err.message || '网络错误',\n        icon: 'none'\n      })\n    }\n\n    return {\n      success: false,\n      errMsg: err.message || '网络错误'\n    }\n  }\n}\n\n// ==================== 用户相关 ====================\n\n/**\n * 用户登录\n */\nexport function userLogin() {\n  return callFunction('userLogin')\n}\n\n// ==================== 儿童档案相关 ====================\n\n/**\n * 获取儿童列表\n */\nexport function getChildren() {\n  return callFunction('getChildren')\n}\n\n/**\n * 添加儿童档案\n */\nexport function addChild(data: {\n  name: string\n  gender: 'male' | 'female'\n  birthday: string\n  bloodType?: string\n  allergies?: string[]\n  notes?: string\n}) {\n  return callFunction('addChild', data, { showLoading: true, loadingText: '添加中...' })\n}\n\n/**\n * 更新儿童信息\n */\nexport function updateChild(data: {\n  childId: string\n  name?: string\n  gender?: 'male' | 'female'\n  birthday?: string\n  bloodType?: string\n  allergies?: string[]\n  notes?: string\n  avatar?: string\n}) {\n  return callFunction('updateChild', data, { showLoading: true, loadingText: '保存中...' })\n}\n\n/**\n * 删除儿童档案\n */\nexport function deleteChild(childId: string) {\n  return callFunction('deleteChild', { childId }, { showLoading: true, loadingText: '删除中...' })\n}\n\n// ==================== 体温记录相关 ====================\n\n/**\n * 添加体温记录\n */\nexport function addTemperature(data: {\n  childId: string\n  temperature: number\n  measureTime: string\n  measurePart?: 'oral' | 'axillary' | 'rectal' | 'ear'\n  notes?: string\n}) {\n  return callFunction('addTemperature', data, { showLoading: true, loadingText: '记录中...' })\n}\n\n/**\n * 获取体温记录\n */\nexport function getTemperatureRecords(data: {\n  childId: string\n  startDate?: string\n  endDate?: string\n  page?: number\n  pageSize?: number\n}) {\n  return callFunction('getTemperatureRecords', data)\n}\n\n// ==================== 用药记录相关 ====================\n\n/**\n * 添加用药记录\n */\nexport function addMedicineRecord(data: {\n  childId: string\n  medicineId?: string\n  medicineName: string\n  dosage?: string\n  unit?: string\n  takeTime: string\n  notes?: string\n}) {\n  return callFunction('addMedicineRecord', data, { showLoading: true, loadingText: '记录中...' })\n}\n\n/**\n * 获取用药记录\n */\nexport function getMedicineRecords(data: {\n  childId: string\n  startDate?: string\n  endDate?: string\n  page?: number\n  pageSize?: number\n}) {\n  return callFunction('getMedicineRecords', data)\n}\n\n// ==================== 症状记录相关 ====================\n\n/**\n * 添加症状记录\n */\nexport function addSymptomRecord(data: {\n  childId: string\n  symptoms: string[]\n  severity?: 'mild' | 'moderate' | 'severe'\n  recordTime: string\n  notes?: string\n}) {\n  return callFunction('addSymptomRecord', data, { showLoading: true, loadingText: '记录中...' })\n}\n\n/**\n * 获取症状记录\n */\nexport function getSymptomRecords(data: {\n  childId: string\n  startDate?: string\n  endDate?: string\n  page?: number\n  pageSize?: number\n}) {\n  return callFunction('getSymptomRecords', data)\n}\n\n// ==================== 统计相关 ====================\n\n/**\n * 获取健康概览\n */\nexport function getHealthOverview(childId: string) {\n  return callFunction('getHealthOverview', { childId })\n}\n\n// ==================== 数据库初始化 ====================\n\n/**\n * 初始化数据库\n */\nexport function initDatabase() {\n  return callFunction('initDatabase', {}, { showLoading: true, loadingText: '初始化中...' })\n}\n"],"names":["uni"],"mappings":";;AAoBA,eAAe,aACb,MACA,OAA4B,CAAA,GAC5B,UAA+B,CAAA,GACE;AACjC,QAAM,EAAE,cAAc,OAAO,cAAc,UAAU,YAAY,KAAS,IAAA;AAE1E,MAAI,aAAa;AACfA,kBAAA,MAAI,YAAY,EAAE,OAAO,aAAa,MAAM,MAAM;AAAA,EACpD;AAEI,MAAA;AACF,UAAM,SAAS,MAAMA,oBAAI,MAAM,aAAa;AAAA,MAC1C;AAAA,MACA;AAAA,IAAA,CACD;AAED,QAAI,aAAa;AACfA,oBAAA,MAAI,YAAY;AAAA,IAClB;AAEA,UAAM,MAAM,OAAO;AAEf,QAAA,CAAC,IAAI,WAAW,WAAW;AAC7BA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO,IAAI,UAAU;AAAA,QACrB,MAAM;AAAA,MAAA,CACP;AAAA,IACH;AAEO,WAAA;AAAA,WACA,KAAU;AACjB,QAAI,aAAa;AACfA,oBAAA,MAAI,YAAY;AAAA,IAClB;AAEAA,wBAAA,MAAA,SAAA,0BAAc,OAAO,IAAI,UAAU,GAAG;AAEtC,QAAI,WAAW;AACbA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO,IAAI,WAAW;AAAA,QACtB,MAAM;AAAA,MAAA,CACP;AAAA,IACH;AAEO,WAAA;AAAA,MACL,SAAS;AAAA,MACT,QAAQ,IAAI,WAAW;AAAA,IAAA;AAAA,EAE3B;AACF;AAOO,SAAS,YAAY;AAC1B,SAAO,aAAa,WAAW;AACjC;AAOO,SAAS,cAAc;AAC5B,SAAO,aAAa,aAAa;AACnC;AAKO,SAAS,SAAS,MAOtB;AACM,SAAA,aAAa,YAAY,MAAM,EAAE,aAAa,MAAM,aAAa,UAAU;AACpF;AAKO,SAAS,YAAY,MASzB;AACM,SAAA,aAAa,eAAe,MAAM,EAAE,aAAa,MAAM,aAAa,UAAU;AACvF;AAKO,SAAS,YAAY,SAAiB;AACpC,SAAA,aAAa,eAAe,EAAE,QAAQ,GAAG,EAAE,aAAa,MAAM,aAAa,SAAA,CAAU;AAC9F;AAOO,SAAS,eAAe,MAM5B;AACM,SAAA,aAAa,kBAAkB,MAAM,EAAE,aAAa,MAAM,aAAa,UAAU;AAC1F;AAKO,SAAS,sBAAsB,MAMnC;AACM,SAAA,aAAa,yBAAyB,IAAI;AACnD;AAOO,SAAS,kBAAkB,MAQ/B;AACM,SAAA,aAAa,qBAAqB,MAAM,EAAE,aAAa,MAAM,aAAa,UAAU;AAC7F;AAKO,SAAS,mBAAmB,MAMhC;AACM,SAAA,aAAa,sBAAsB,IAAI;AAChD;AAOO,SAAS,iBAAiB,MAM9B;AACM,SAAA,aAAa,oBAAoB,MAAM,EAAE,aAAa,MAAM,aAAa,UAAU;AAC5F;AAKO,SAAS,kBAAkB,MAM/B;AACM,SAAA,aAAa,qBAAqB,IAAI;AAC/C;AAOO,SAAS,kBAAkB,SAAiB;AACjD,SAAO,aAAa,qBAAqB,EAAE,QAAS,CAAA;AACtD;;;;;;;;;;;;;"}