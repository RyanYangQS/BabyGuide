{"version":3,"file":"children.js","sources":["src/store/modules/children.ts"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { ref } from 'vue'\nimport type { Child } from '../types'\n\nexport const useChildrenStore = defineStore('children', () => {\n  // 当前选中的儿童\n  const currentChild = ref<Child | null>(null)\n  \n  // 儿童列表\n  const childrenList = ref<Child[]>([])\n  \n  // 加载状态\n  const loading = ref(false)\n  \n  /**\n   * 设置当前儿童\n   */\n  function setCurrentChild(child: Child | null) {\n    currentChild.value = child\n    if (child) {\n      uni.setStorageSync('currentChildId', child._id)\n    } else {\n      uni.removeStorageSync('currentChildId')\n    }\n  }\n  \n  /**\n   * 设置儿童列表\n   */\n  function setChildrenList(list: Child[]) {\n    childrenList.value = list\n  }\n  \n  /**\n   * 添加儿童到列表\n   */\n  function addChild(child: Child) {\n    childrenList.value.push(child)\n  }\n  \n  /**\n   * 更新儿童信息\n   */\n  function updateChild(child: Child) {\n    const index = childrenList.value.findIndex(c => c._id === child._id)\n    if (index !== -1) {\n      childrenList.value[index] = child\n      if (currentChild.value?._id === child._id) {\n        currentChild.value = child\n      }\n    }\n  }\n  \n  /**\n   * 删除儿童\n   */\n  function removeChild(childId: string) {\n    childrenList.value = childrenList.value.filter(c => c._id !== childId)\n    if (currentChild.value?._id === childId) {\n      currentChild.value = childrenList.value[0] || null\n    }\n  }\n  \n  /**\n   * 从本地存储恢复当前儿童\n   */\n  function restoreCurrentChild() {\n    const currentChildId = uni.getStorageSync('currentChildId')\n    if (currentChildId && childrenList.value.length > 0) {\n      const child = childrenList.value.find(c => c._id === currentChildId)\n      if (child) {\n        currentChild.value = child\n      } else if (childrenList.value.length > 0) {\n        currentChild.value = childrenList.value[0]\n      }\n    } else if (childrenList.value.length > 0) {\n      currentChild.value = childrenList.value[0]\n    }\n  }\n  \n  return {\n    currentChild,\n    childrenList,\n    loading,\n    setCurrentChild,\n    setChildrenList,\n    addChild,\n    updateChild,\n    removeChild,\n    restoreCurrentChild\n  }\n})\n"],"names":["defineStore","ref","uni"],"mappings":";;AAIa,MAAA,mBAAmBA,cAAAA,YAAY,YAAY,MAAM;AAEtD,QAAA,eAAeC,kBAAkB,IAAI;AAGrC,QAAA,eAAeA,kBAAa,CAAA,CAAE;AAG9B,QAAA,UAAUA,kBAAI,KAAK;AAKzB,WAAS,gBAAgB,OAAqB;AAC5C,iBAAa,QAAQ;AACrB,QAAI,OAAO;AACLC,oBAAAA,MAAA,eAAe,kBAAkB,MAAM,GAAG;AAAA,IAAA,OACzC;AACLA,0BAAI,kBAAkB,gBAAgB;AAAA,IACxC;AAAA,EACF;AAKA,WAAS,gBAAgB,MAAe;AACtC,iBAAa,QAAQ;AAAA,EACvB;AAKA,WAAS,SAAS,OAAc;AACjB,iBAAA,MAAM,KAAK,KAAK;AAAA,EAC/B;AAKA,WAAS,YAAY,OAAc;;AAC3B,UAAA,QAAQ,aAAa,MAAM,UAAU,OAAK,EAAE,QAAQ,MAAM,GAAG;AACnE,QAAI,UAAU,IAAI;AACH,mBAAA,MAAM,KAAK,IAAI;AAC5B,YAAI,kBAAa,UAAb,mBAAoB,SAAQ,MAAM,KAAK;AACzC,qBAAa,QAAQ;AAAA,MACvB;AAAA,IACF;AAAA,EACF;AAKA,WAAS,YAAY,SAAiB;;AACpC,iBAAa,QAAQ,aAAa,MAAM,OAAO,CAAK,MAAA,EAAE,QAAQ,OAAO;AACjE,UAAA,kBAAa,UAAb,mBAAoB,SAAQ,SAAS;AACvC,mBAAa,QAAQ,aAAa,MAAM,CAAC,KAAK;AAAA,IAChD;AAAA,EACF;AAKA,WAAS,sBAAsB;AACvB,UAAA,iBAAiBA,cAAAA,MAAI,eAAe,gBAAgB;AAC1D,QAAI,kBAAkB,aAAa,MAAM,SAAS,GAAG;AACnD,YAAM,QAAQ,aAAa,MAAM,KAAK,CAAK,MAAA,EAAE,QAAQ,cAAc;AACnE,UAAI,OAAO;AACT,qBAAa,QAAQ;AAAA,MACZ,WAAA,aAAa,MAAM,SAAS,GAAG;AAC3B,qBAAA,QAAQ,aAAa,MAAM,CAAC;AAAA,MAC3C;AAAA,IACS,WAAA,aAAa,MAAM,SAAS,GAAG;AAC3B,mBAAA,QAAQ,aAAa,MAAM,CAAC;AAAA,IAC3C;AAAA,EACF;AAEO,SAAA;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ,CAAC;;"}