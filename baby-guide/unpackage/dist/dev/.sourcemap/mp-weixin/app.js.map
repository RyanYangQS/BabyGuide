{"version":3,"file":"app.js","sources":["App.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { onHide, onLaunch, onShow } from '@dcloudio/uni-app'\nimport { userLogin } from './src/api'\nimport { useChildrenStore } from './src/store/modules/children'\n\nonLaunch(async () => {\n  uni.__f__('log','at App.vue:7','App Launch')\n  \n  // 初始化云开发\n  if (!uni.cloud) {\n    uni.__f__('error','at App.vue:11','当前环境不支持云开发')\n    uni.showModal({\n      title: '提示',\n      content: '当前环境不支持云开发，请使用微信真机预览',\n      showCancel: false\n    })\n    return\n  }\n  \n  try {\n    uni.cloud.init({\n      env: 'cloud1-4gc1m9gl2ae51c9c',\n      traceUser: true\n    })\n    uni.__f__('log','at App.vue:25','云开发初始化成功')\n  } catch (err) {\n    uni.__f__('error','at App.vue:27','云开发初始化失败:', err)\n    uni.showToast({\n      title: '云开发初始化失败',\n      icon: 'none'\n    })\n    return\n  }\n  \n  // 自动登录\n  await doLogin()\n})\n\nasync function doLogin() {\n  try {\n    uni.showLoading({ title: '登录中...', mask: true })\n    \n    const res = await userLogin()\n    \n    uni.hideLoading()\n    \n    if (res.success) {\n      uni.__f__('log','at App.vue:48','用户登录成功', res.data?.isNewUser ? '(新用户)' : '(老用户)')\n      \n      // 加载儿童列表\n      const childrenStore = useChildrenStore()\n      await childrenStore.fetchChildren()\n      \n      if (res.data?.isNewUser) {\n        uni.__f__('log','at App.vue:55','新用户，欢迎！')\n      }\n    } else {\n      uni.__f__('error','at App.vue:58','登录失败:', res.errMsg)\n      uni.showModal({\n        title: '登录失败',\n        content: res.errMsg || '请检查网络后重试',\n        showCancel: false\n      })\n    }\n  } catch (err: any) {\n    uni.hideLoading()\n    uni.__f__('error','at App.vue:67','登录异常:', err)\n    uni.showModal({\n      title: '登录异常',\n      content: err.message || '网络错误，请重试',\n      showCancel: false\n    })\n  }\n}\n\nonShow(() => {\n  uni.__f__('log','at App.vue:77','App Show')\n})\n\nonHide(() => {\n  uni.__f__('log','at App.vue:81','App Hide')\n})\n</script>\n\n<style lang=\"scss\">\n/* 自定义主题色 */\npage {\n  --primary-color: #4A90E2;\n  --success-color: #52C41A;\n  --warning-color: #FAAD14;\n  --error-color: #FF4D4F;\n  --info-color: #909399;\n}\n</style>\n"],"names":["onLaunch","uni","userLogin","useChildrenStore","onShow","onHide"],"mappings":";;;;;;;;;;;;;;;;AAKAA,kBAAAA,SAAS,YAAY;AACfC,oBAAAA,MAAA,MAAM,OAAM,gBAAe,YAAY;AAGvC,UAAA,CAACA,oBAAI,OAAO;AACVA,sBAAAA,MAAA,MAAM,SAAQ,iBAAgB,YAAY;AAC9CA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,SAAS;AAAA,UACT,YAAY;AAAA,QAAA,CACb;AACD;AAAA,MACF;AAEI,UAAA;AACFA,sBAAA,MAAI,MAAM,KAAK;AAAA,UACb,KAAK;AAAA,UACL,WAAW;AAAA,QAAA,CACZ;AACGA,sBAAAA,MAAA,MAAM,OAAM,iBAAgB,UAAU;AAAA,eACnC,KAAK;AACZA,sBAAA,MAAI,MAAM,SAAQ,iBAAgB,aAAa,GAAG;AAClDA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACP;AACD;AAAA,MACF;AAGA,YAAM,QAAQ;AAAA,IAAA,CACf;AAED,mBAAe,UAAU;;AACnB,UAAA;AACFA,sBAAA,MAAI,YAAY,EAAE,OAAO,UAAU,MAAM,MAAM;AAEzC,cAAA,MAAM,MAAMC,cAAAA;AAElBD,sBAAA,MAAI,YAAY;AAEhB,YAAI,IAAI,SAAS;AACXA,wBAAAA,MAAA,MAAM,OAAM,iBAAgB,YAAU,SAAI,SAAJ,mBAAU,aAAY,UAAU,OAAO;AAGjF,gBAAM,gBAAgBE,2BAAAA;AACtB,gBAAM,cAAc;AAEhB,eAAA,SAAI,SAAJ,mBAAU,WAAW;AACnBF,0BAAAA,MAAA,MAAM,OAAM,iBAAgB,SAAS;AAAA,UAC3C;AAAA,QAAA,OACK;AACLA,wBAAA,MAAI,MAAM,SAAQ,iBAAgB,SAAS,IAAI,MAAM;AACrDA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,SAAS,IAAI,UAAU;AAAA,YACvB,YAAY;AAAA,UAAA,CACb;AAAA,QACH;AAAA,eACO,KAAU;AACjBA,sBAAA,MAAI,YAAY;AAChBA,sBAAA,MAAI,MAAM,SAAQ,iBAAgB,SAAS,GAAG;AAC9CA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,SAAS,IAAI,WAAW;AAAA,UACxB,YAAY;AAAA,QAAA,CACb;AAAA,MACH;AAAA,IACF;AAEAG,kBAAAA,OAAO,MAAM;AACPH,oBAAAA,MAAA,MAAM,OAAM,iBAAgB,UAAU;AAAA,IAAA,CAC3C;AAEDI,kBAAAA,OAAO,MAAM;AACPJ,oBAAAA,MAAA,MAAM,OAAM,iBAAgB,UAAU;AAAA,IAAA,CAC3C;;;;;;;;;;;;;;;;;"}